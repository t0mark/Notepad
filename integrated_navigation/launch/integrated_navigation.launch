<?xml version="1.0"?>
<launch>
  <!-- 통합 자율주행 네비게이션 시스템 -->
  <!-- Faster-LIO + DWA + Kakao API 통합 -->

  <!-- 시뮬레이션 시간 설정 -->
  <param name="use_sim_time" value="true"/>

  <!-- Arguments -->
  <arg name="enable_rviz" default="true"/>
  <arg name="enable_faster_lio_rviz" default="false"/>

  <!-- ========================================= -->
  <!-- 1. Faster-LIO (LiDAR Odometry) -->
  <!-- ========================================= -->
  <include file="$(find faster_lio)/launch/mapping_ouster64.launch">
    <arg name="rviz" value="$(arg enable_faster_lio_rviz)"/>
  </include>

  <!-- ========================================= -->
  <!-- 2. UTM Local 좌표계 설정 및 GPS-FasterLIO 동기화 -->
  <!-- ========================================= -->
  <node pkg="integrated_navigation" type="make_frame.py" name="make_frame_node" output="screen"/>

  <!-- 3. FasterLIO-GPS 융합 위치 추정 및 Heading 보정 -->
  <node pkg="integrated_navigation" type="initialize_pose.py" name="initialize_pose_node" output="screen"/>

  <!-- ========================================= -->
  <!-- 4. DWA Navigation (Move Base) -->
  <!-- ========================================= -->
  <include file="$(find dwa)/launch/dwa_navigation.launch">
    <arg name="global_frame" value="utm_local"/>
    <arg name="enable_rviz" value="$(arg enable_rviz)"/>
  </include>

  <!-- ========================================= -->
  <!-- 5. Kakao API (GPS 서버 및 웨이포인트 관리) -->
  <!-- ========================================= -->
  <include file="$(find kakao_api)/launch/kakao_api.launch"/>

  <!-- ========================================= -->
  <!-- 6. 경로 및 웨이포인트 시각화 -->
  <!-- ========================================= -->
  <node pkg="integrated_navigation" type="path_visualizer.py" name="path_visualizer_node" output="screen"/>

</launch>